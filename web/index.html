<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>City Charity</title>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
<div class="wrap">
    <!-- Header -->
    <header class="header">
        <div class="brand">
            <div class="logo">
                <img src="images/006-charity.png" alt="Logo" />
            </div>
            <div class="brand-meta">
                <h1 class="brand-title">City Charity</h1>
                <p class="brand-sub" id="subtitle">
                    Find community events and fundraisers
                </p>
            </div>
        </div>
        <nav class="nav">
            <a class="pill" href="/">Home</a>
            <a class="pill" href="/search.html">Search</a>
        </nav>
    </header>

    <!-- Welcome -->
    <section class="panel top">
        <div class="top-text">
            <h2>Welcome to City Charity</h2>
            <p class="pr">Discover local causes, join community events, and support what you care about. Browse upcoming highlights below or open the search to filter by city, time, and category.</p>
        </div>

        <!-- Banner -->
        <div class="top-banner">
            <div class="banner-track" id="bannerTrack">
                <div class="banner-slide">
                    <img src="images/banner-3.jpg" />
                </div>
            </div>
        </div>
    </section>

    <!-- Upcoming highlights -->
    <section>
        <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:8px">
            <h3 style="margin:0">Active events</h3>
            <small class="pr" id="resultHint">â€”</small>
        </div>
        <div class="grid" id="eventsGrid"></div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <small>Powered by KAJSE</small>
    </footer>
</div>

<script src="common.js"></script>
<script>
  function loadActiveEvents(){
    return getJSON('/events?status=all').then(function(items){
      renderEvents(items);
      $('#resultHint').textContent = 'Showing '+items.length+' active events';
    }).catch(function(){
      $('#eventsGrid').innerHTML = '<div class="list-empty"><p class="pr">Failed to load events</p></div>';
      $('#resultHint').textContent = '';
    });
  }

  function renderEvents(items){
    var grid = $('#eventsGrid');
    if(!items.length){
      grid.innerHTML = '<div class="list-empty"><p class="pr">No upcoming events</p></div>';
      return;
    }
    var html = '';
    for(var i=0;i<items.length;i++){
      var e = items[i];
      html += eventContent(e);
    }
    grid.innerHTML = html;
  }

  loadActiveEvents();
</script>
</body>
</html>
